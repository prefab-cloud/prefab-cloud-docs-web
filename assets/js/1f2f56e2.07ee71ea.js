"use strict";(self.webpackChunkprefab_cloud_docs_web=self.webpackChunkprefab_cloud_docs_web||[]).push([[2369],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>b});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},f=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),f=r,b=p["".concat(s,".").concat(f)]||p[f]||d[f]||o;return n?a.createElement(b,i(i({ref:t},u),{},{components:n})):a.createElement(b,i({ref:t},u))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=f;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=n[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}f.displayName="MDXCreateElement"},461:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>d,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=n(7462),r=(n(7294),n(3905));const o={title:"How Frontend SDKs Work",sidebar_label:"Frontend SDKs",sidebar_position:2},i=void 0,l={unversionedId:"explanations/concepts/frontend-sdks",id:"explanations/concepts/frontend-sdks",title:"How Frontend SDKs Work",description:"Frontend Architecture",source:"@site/docs/explanations/concepts/frontend-sdks.md",sourceDirName:"explanations/concepts",slug:"/explanations/concepts/frontend-sdks",permalink:"/docs/explanations/concepts/frontend-sdks",draft:!1,editUrl:"https://github.com/prefab-cloud/prefab-cloud-docs-web/tree/main/docs/explanations/concepts/frontend-sdks.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"How Frontend SDKs Work",sidebar_label:"Frontend SDKs",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Backend SDKs",permalink:"/docs/explanations/concepts/backend-sdks"},next:{title:"Context",permalink:"/docs/explanations/concepts/context"}},s={},c=[{value:"Frontend Architecture",id:"frontend-architecture",level:2},{value:"Client Side Reliability",id:"client-side-reliability",level:2}],u={toc:c},p="wrapper";function d(e){let{components:t,...n}=e;return(0,r.kt)(p,(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"frontend-architecture"},"Frontend Architecture"),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},'To prevent accidentally leaking sensitive config information, frontend SDKs do not receive Configs by default. You can enable frontend availability for any individual config using the "Send to frontend SDKs" checkbox in the Prefab UI.')),(0,r.kt)("p",null,"The frontend architecture has different goals and different operating characteristics from the backend SDKs. The goals of the clients are:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Make lookups as fast as possible"),(0,r.kt)("li",{parentName:"ol"},"Don't leak raw configuration data to the end user"),(0,r.kt)("li",{parentName:"ol"},"Give clear and configurable behavior options if a connection cannot be made")),(0,r.kt)("p",null,"With those goals in mind, the architecture is:"),(0,r.kt)("mermaid",{value:'flowchart TB\n\n    subgraph Prefab\n        direction LR\n        CDN\n        GDN["Global Delivery Network (belt)"]\n        API["API (suspenders)"]\n\n        GoogleSpanner[("Google Spanner")]\n    end\n\n    subgraph "Your JS app"\n        subgraph "Your Code"\n            setup\n            code["prefab.enabled?(my-flag)"]\n        end\n\n        subgraph "Prefab Frontend SDK"\n            init\n            ResultsCache["Cached evaluated flags for user"]\n            ResultsCache --\x3e code\n            code --\x3e ResultsCache\n        end\n    end\n\n    setup -- Context + API Key--\x3e init\n    init --belt--\x3e CDN\n    init -.suspenders.-> CDN\n    CDN -.suspenders miss.-> API\n    CDN -.belt miss.-> GDN\n    API --suspenders update--\x3e CDN\n    GDN --belt update--\x3e CDN\n    CDN --\x3e ResultsCache\n    API --\x3e GoogleSpanner\n    GoogleSpanner --\x3e API'}),(0,r.kt)("p",null,'Usually, clients will make a single request and receive the values of all evaluated Feature Flags for a given context. The client uses a belt and suspenders approach for reliability, so if the "belt" request isn\'t timely, we\'ll fall back to the "suspenders" endpoint.'),(0,r.kt)("p",null,"If you change the attributes of a context and re-initialize the client, we'll re-fetch the flags for that context."),(0,r.kt)("p",null,"Note that ",(0,r.kt)("strong",{parentName:"p"},"evaluation happens server side"),". This prevents your potentially sensitive rule data from leaking to an untrusted browser. For example if you\nhave a ",(0,r.kt)("inlineCode",{parentName:"p"},"special-feature")," released to a list of customer IDs, the browser will only see ",(0,r.kt)("inlineCode",{parentName:"p"},"special-feature: false")," not the list of your special customer IDs."),(0,r.kt)("p",null,"The client will be returned a list that is basically:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "feature.exp12-big-button": "control",\n  "feature.exp14-button-class": "very-blue",\n  "feature.risky-business": true\n}\n')),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"/docs/explanations/concepts/backend-sdks"},"backend SDKs")," to compare this approach to in-memory rule evaluation."),(0,r.kt)("h2",{id:"client-side-reliability"},"Client Side Reliability"),(0,r.kt)("p",null,"Each end-user that needs flags evaluated is a different request to Prefab. So what happens if Prefab's belt and suspenders are both down?"),(0,r.kt)("p",null,"First the good news. All ",(0,r.kt)("strong",{parentName:"p"},"active")," users will be unaffected, because they will have cached values in the CDN.\nIf you make a change to your feature flags, it won't be reflected, but logged-in users will be served the most\nrecent evaluation of the flags."),(0,r.kt)("p",null,"The less good news. If a ",(0,r.kt)("a",{parentName:"p",href:"/docs/explanations/concepts/context"},"context")," that has not been seen before asks for evaluation, that will not have been cached. After a configurable timeout the client will fallback to default values.\nWithout values, your ",(0,r.kt)("inlineCode",{parentName:"p"},"isEnabled")," checks will return ",(0,r.kt)("inlineCode",{parentName:"p"},"false"),"."),(0,r.kt)("p",null,"Frontend config will return ",(0,r.kt)("inlineCode",{parentName:"p"},"undefined")," and you can use the pattern ",(0,r.kt)("inlineCode",{parentName:"p"},'prefab.get("thing") ?? "this-is-my-default"')," to set a default."),(0,r.kt)("p",null,"The default timeout is ",(0,r.kt)("inlineCode",{parentName:"p"},"10")," seconds, but you can set this in client initialization."),(0,r.kt)("p",null,"You can run your own JS/React evaluation endpoint using the prefab CLI's ",(0,r.kt)("a",{parentName:"p",href:"/docs/tools/cli#download"},"download")," and ",(0,r.kt)("a",{parentName:"p",href:"/docs/tools/cli#serve"},"serve")," commands. If you have questions about this or our reliability roadmap, contact us and we'll share what we're working on."))}d.isMDXComponent=!0}}]);