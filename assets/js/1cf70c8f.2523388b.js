"use strict";(self.webpackChunkprefab_cloud_docs_web=self.webpackChunkprefab_cloud_docs_web||[]).push([[6507],{9791:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>c});var t=i(4848),a=i(8453);const s={title:"Ruby"},r=void 0,o={id:"sdks/ruby",title:"Ruby",description:"Install the latest version",source:"@site/docs/sdks/ruby.md",sourceDirName:"sdks",slug:"/sdks/ruby",permalink:"/docs/sdks/ruby",draft:!1,unlisted:!1,editUrl:"https://github.com/prefab-cloud/prefab-cloud-docs-web/tree/main/docs/sdks/ruby.md",tags:[],version:"current",frontMatter:{title:"Ruby"},sidebar:"tutorialSidebar",previous:{title:"React",permalink:"/docs/sdks/react"}},l={},c=[{value:"Install the latest version",id:"install-the-latest-version",level:2},{value:"Initialize Client",id:"initialize-client",level:2},{value:"Rails Applications",id:"rails-applications",level:3},{value:"Special Considerations with Forking servers like Puma &amp; Unicorn that use workers",id:"special-considerations-with-forking-servers-like-puma--unicorn-that-use-workers",level:4},{value:"Feature Flags",id:"feature-flags",level:2},{value:"Context",id:"context",level:2},{value:"Global Context",id:"global-context",level:3},{value:"Thread-local (Request-scoped)",id:"thread-local-request-scoped",level:3},{value:"Dynamic Config",id:"dynamic-config",level:2},{value:"Default Values for Configs",id:"default-values-for-configs",level:4},{value:"Dynamic Log Levels",id:"dynamic-log-levels",level:2},{value:"Targeted Log Levels",id:"targeted-log-levels",level:3},{value:"Telemetry",id:"telemetry",level:2},{value:"Debugging",id:"debugging",level:2},{value:"Asset Precompilation in Rails",id:"asset-precompilation-in-rails",level:2},{value:"Bootstrap &amp; Stub Client-side JavaScript flags and configs",id:"bootstrap--stub-client-side-javascript-flags-and-configs",level:2},{value:"With the Frontend SDKs",id:"with-the-frontend-sdks",level:3},{value:"Without the Frontend SDKs",id:"without-the-frontend-sdks",level:3},{value:"Testing",id:"testing",level:2},{value:"Test Setup",id:"test-setup",level:3},{value:"Example Test",id:"example-test",level:3},{value:"Reference",id:"reference",level:2},{value:"Client Initialization Options",id:"client-initialization-options",level:3}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components},{Details:i,TabItem:s,Tabs:r}=n;return i||h("Details",!0),s||h("TabItem",!0),r||h("Tabs",!0),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"install-the-latest-version",children:"Install the latest version"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:" gem install prefab-cloud-ruby\n"})}),"\n",(0,t.jsx)(n.h2,{id:"initialize-client",children:"Initialize Client"}),"\n",(0,t.jsxs)(n.p,{children:["If you set ",(0,t.jsx)(n.code,{children:"PREFAB_API_KEY"})," as an environment variable, initializing the client is as easy as"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"Prefab.init # reads PREFAB_API_KEY env var by default\n"})}),"\n",(0,t.jsx)(n.h3,{id:"rails-applications",children:"Rails Applications"}),"\n",(0,t.jsxs)(n.p,{children:["Initializing Prefab in your ",(0,t.jsx)(n.code,{children:"application.rb"})," will allow you to reference dynamic configuration in your environment (e.g. ",(0,t.jsx)(n.code,{children:"staging.rb"}),") and initializers. This is useful for setting environment-specific config like your redis connection URL."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"#application.rb\nmodule MyApplication\n  class Application < Rails::Application\n    #...\n\n    Prefab.init\n  end\nend\n"})}),"\n",(0,t.jsxs)(i,{className:"alert--warning",children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.h4,{id:"special-considerations-with-forking-servers-like-puma--unicorn-that-use-workers",children:"Special Considerations with Forking servers like Puma & Unicorn that use workers"})}),(0,t.jsx)(n.p,{children:"Many ruby web servers fork. In order to work properly we should have a Prefab Client running independently in each fork. You do not need to do this if you are only using threads and not workers.\nIf using SemanticLogger, you will also need to reopen the logger in each fork."}),(0,t.jsxs)(r,{groupId:"lang",children:[(0,t.jsxs)(s,{value:"puma",label:"Puma",children:[(0,t.jsx)(n.p,{children:"If using workers in Puma, you can initialize inside an on_worker_boot hook in your puma.rb config file."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"# puma.rb\non_worker_boot do\n  Prefab.fork\n  SemanticLogger.reopen # if you are using SemanticLogger\nend\n"})})]}),(0,t.jsxs)(s,{value:"unicorn",label:"Unicorn",children:[(0,t.jsx)(n.p,{children:"If using workers in Unicorn, you can initialize inside an after_fork hook in your unicorn.rb config file:"}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"# unicorn.rb\nafter_fork do |server, worker|\n  Prefab.fork\n  SemanticLogger.reopen # if you are using SemanticLogger\nend\n"})})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"feature-flags",children:"Feature Flags"}),"\n",(0,t.jsxs)(n.p,{children:["For boolean flags, you can use the ",(0,t.jsx)(n.code,{children:"enabled?"})," convenience method:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'if Prefab.enabled?("my-first-feature-flag")\n  # ...\nelse\n  # ...\nend\n'})}),"\n",(0,t.jsxs)(i,{className:"alert--info",children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.p,{children:"Feature flags don't have to return just true or false."})}),(0,t.jsxs)(n.p,{children:["You can get other data types using ",(0,t.jsx)(n.code,{children:"get"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'Prefab.get("ff-with-string")\nPrefab.get("ff-with-int")\n'})})]}),"\n",(0,t.jsx)(n.h2,{id:"context",children:"Context"}),"\n",(0,t.jsxs)(n.p,{children:["Feature flags become more powerful when we give the flag evaluation rules more information to work with. We do this by providing ",(0,t.jsx)(n.a,{href:"/docs/explanations/concepts/context",children:"context"})," of the current user (and/or team, request, etc.)"]}),"\n",(0,t.jsx)(n.h3,{id:"global-context",children:"Global Context"}),"\n",(0,t.jsx)(n.p,{children:"When initializing the client, you can set a global context that will be used for all evaluations."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'Prefab.init(\n  global_context: {\n    application: {key: "my.corp.web"},\n    cpu: {count: 4},\n    clock: {timezone: "UTC"}\n  }\n)\n'})}),"\n",(0,t.jsx)(n.p,{children:"Global context is the least specific context and will be overridden by more specific context passed in at the time of evaluation."}),"\n",(0,t.jsx)(n.h3,{id:"thread-local-request-scoped",children:"Thread-local (Request-scoped)"}),"\n",(0,t.jsxs)(n.p,{children:["To make the best use of Prefab, we recommend setting ",(0,t.jsx)(n.a,{href:"/docs/explanations/concepts/context",children:"context"})," in an ",(0,t.jsx)(n.code,{children:"around_action"})," in your ",(0,t.jsx)(n.code,{children:"ApplicationController"}),". Setting this context for the life-cycle of the request means the Prefab logger can be aware of your user/etc. for feature flags and ",(0,t.jsx)(n.a,{href:"/docs/explanations/features/targeted-log-levels",children:"targeted log levels"})," and you won't have to explicitly pass context into your ",(0,t.jsx)(n.code,{children:".enabled?"})," and ",(0,t.jsx)(n.code,{children:".get"})," calls."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"# application_controller.rb\nclass ApplicationController < ActionController::Base\n  around_action do |_, block|\n    Prefab.with_context(prefab_context, &block)\n  end\n\n  def prefab_context\n    {\n      device: {\n        mobile: mobile?\n        # ...\n      },\n    }.merge(prefab_user_context)\n  end\n\n  def prefab_user_context\n    return {} unless current_user\n\n    {\n      key: current_user.tracking_id,\n      id: current_user.id,\n      email: current_user.email,\n      country: current_user.country,\n      # ...\n    }\n  end\nend\n"})}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.p,{children:"Just-in-time Context"})}),(0,t.jsx)(n.p,{children:"You can also pass context when evaluating individual flags or config values."}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'context = {\n  user: {\n    id: 123,\n    key: \'user-123\',\n    subscription_level: \'pro\',\n    email: "alice@example.com"\n  },\n  team: {\n    id: 432,\n    key: \'team-abc\',\n  },\n  device: {\n    key: "abcdef",\n    mobile: true,\n  }\n}\nresult = Prefab.enabled?("my-first-feature-flag", context)\n\nputs "my-first-feature-flag is: #{result} for #{context.inspect}"\n'})})]}),"\n",(0,t.jsx)(n.h2,{id:"dynamic-config",children:"Dynamic Config"}),"\n",(0,t.jsxs)(n.p,{children:["Config values are accessed the same way as feature flag values. You can use ",(0,t.jsx)(n.code,{children:"enabled?"})," as a convenience for boolean values, and ",(0,t.jsx)(n.code,{children:"get"})," works for all data types"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'config_key = "my-first-int-config"\nputs "#{config_key} is: #{Prefab.get(config_key)}"\n'})}),"\n",(0,t.jsxs)(i,{children:[(0,t.jsx)("summary",{children:(0,t.jsx)(n.h4,{id:"default-values-for-configs",children:"Default Values for Configs"})}),(0,t.jsxs)(n.p,{children:["Here we ask for the value of a config named ",(0,t.jsx)(n.code,{children:"max-jobs-per-second"}),", and we specify ",(0,t.jsx)(n.code,{children:"10"})," as a default value if no value is available."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'Prefab.get("max-jobs-per-second", 10) # => returns `10` if no value is available\n'})}),(0,t.jsxs)(n.p,{children:["If we don't provide a default and no value is available, a ",(0,t.jsx)(n.code,{children:"Prefab::Errors::MissingDefaultError"})," error will be raised."]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'Prefab.get("max-jobs-per-second") # => raises if no value is available\n'})}),(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["You can modify this behavior by setting the option ",(0,t.jsx)(n.code,{children:"on_no_default"})," to ",(0,t.jsx)(n.code,{children:"Prefab::Options::ON_NO_DEFAULT::RETURN_NIL"})]})})]}),"\n",(0,t.jsx)(n.h2,{id:"dynamic-log-levels",children:"Dynamic Log Levels"}),"\n",(0,t.jsxs)(n.p,{children:["To use dynamic logging, we recommend ",(0,t.jsx)(n.a,{href:"https://logger.rocketjob.io/",children:"semantic logger"}),". Add semantic_logger to your Gemfile and then we'll configure our app to use it."]}),"\n",(0,t.jsxs)(r,{groupId:"ruby-usage",children:[(0,t.jsxs)(s,{value:"ruby",label:"Ruby",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'# Gemfile\ngem "semantic_logger"\n'})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'require "semantic_logger"\nrequire "prefab"\n\nPrefab.init\n\nSemanticLogger.sync!\nSemanticLogger.default_level = :trace # Prefab will take over the filtering\nSemanticLogger.add_appender(\n  io: $stdout,\n  formatter: :json,\n  filter: Prefab.log_filter,\n)\n'})})]}),(0,t.jsxs)(s,{value:"rails",label:"Rails",children:[(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:'# Gemfile\ngem "amazing_print"\ngem "rails_semantic_logger"\n'})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"# config/application.rb\nPrefab.init\n"})}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"# config/initializers/logging.rb\nSemanticLogger.sync!\nSemanticLogger.default_level = :trace # Prefab will take over the filtering\nSemanticLogger.add_appender(\n  io: $stdout,\n  formatter: Rails.env.development? ? :color : :json,\n  filter: Prefab.log_filter,\n)\n"})}),(0,t.jsx)(n.admonition,{type:"caution",children:(0,t.jsxs)(n.p,{children:["Please read the ",(0,t.jsx)(n.a,{href:"ruby#special-considerations-with-forking-servers-like-puma--unicorn-that-use-workers",children:"Puma/Unicorn"})," notes for special considerations with forking servers."]})})]})]}),"\n",(0,t.jsx)(n.p,{children:"Now we are free to adjust our log levels, down to the controller or method level in real-time. Invaluable for debugging! You can set and tweak these on-the-fly in the Prefab web app."}),"\n",(0,t.jsx)(n.h3,{id:"targeted-log-levels",children:"Targeted Log Levels"}),"\n",(0,t.jsxs)(n.p,{children:["You can use ",(0,t.jsx)(n.a,{href:"/docs/explanations/features/targeted-log-levels",children:"Targeting"})," to change your log levels based on the current user/request/device context using our ",(0,t.jsx)(n.a,{href:"/docs/explanations/features/rules-and-segmentation",children:"rules"})," engine."]}),"\n",(0,t.jsx)(n.h2,{id:"telemetry",children:"Telemetry"}),"\n",(0,t.jsx)(n.p,{children:"By default, Prefab uploads telemetry that enables a number of useful features. You can alter or disable this behavior using the following options:"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"Name"}),(0,t.jsx)(n.th,{children:"Description"}),(0,t.jsx)(n.th,{children:"Default"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"collect_evaluation_summaries"}),(0,t.jsx)(n.td,{children:"Send counts of config/flag evaluation results back to Prefab to view in web app"}),(0,t.jsx)(n.td,{children:"true"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"collect_logger_counts"}),(0,t.jsx)(n.td,{children:"Send counts of logger usage back to Prefab to power log-levels configuration screen"}),(0,t.jsx)(n.td,{children:"true"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"context_upload_mode"}),(0,t.jsx)(n.td,{children:'Upload either context "shapes" (the names and data types your app uses in prefab contexts) or periodically send full example contexts'}),(0,t.jsx)(n.td,{children:":periodic_example"})]})]})]}),"\n",(0,t.jsxs)(n.p,{children:["If you want to change any of these options, you can pass an ",(0,t.jsx)(n.code,{children:"options"})," object when initializing the Prefab client."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"#application.rb\nmodule MyApplication\n  class Application < Rails::Application\n    #...\n\n    // highlight-start\n    options = Prefab::Options.new(\n      collect_evaluation_summaries: true,\n      collect_logger_counts: true,\n      context_upload_mode: :periodic_example,\n    )\n\n    Prefab.init(options)\n    // highlight-end\n  end\nend\n"})}),"\n",(0,t.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,t.jsxs)(n.p,{children:["You can control the Prefab client's log level by changing the configuration value of ",(0,t.jsx)(n.code,{children:"log-level.cloud.prefab"}),". In the rare\ncase that you are trying to debug issues that occur before this config file has been read, set env var"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"PREFAB_LOG_CLIENT_BOOTSTRAP_LOG_LEVEL = debug\n"})}),"\n",(0,t.jsx)(n.h2,{id:"asset-precompilation-in-rails",children:"Asset Precompilation in Rails"}),"\n",(0,t.jsxs)(n.p,{children:["Developers trying to run ",(0,t.jsx)(n.code,{children:"rake assets:precompile"})," or ",(0,t.jsx)(n.code,{children:"rails assets:precompile"})," in CI/CD know the pain of missing environment variables. Prefab can help with this, but you don't want to hardcode your Prefab API key in your Dockerfile. What should you do instead?"]}),"\n",(0,t.jsxs)(n.p,{children:["We recommend using a ",(0,t.jsx)(n.a,{href:"/docs/explanations/concepts/testing#testing-with-datafiles",children:"datafile"})," for ",(0,t.jsx)(n.code,{children:"assets:precompile"}),". You can generate a datafile for your environment using the Prefab CLI:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"prefab download --environment test\n"})}),"\n",(0,t.jsxs)(n.p,{children:["This will generate a JSON file (e.g., ",(0,t.jsx)(n.code,{children:"prefab.test.108.config.json"}),") based on your Prefab project\u2019s test environment. You can check into your repo for use in CI/CD and automated testing."]}),"\n",(0,t.jsxs)(n.p,{children:["Now you can use the datafile for ",(0,t.jsx)(n.code,{children:"assets:precompile"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"PREFAB_DATAFILE=prefab.test.108.config.json bundle exec rake assets:precompile\n"})}),"\n",(0,t.jsx)(n.p,{children:"Of course, you can generate a datafile for any environment you like and use it in the same way."}),"\n",(0,t.jsx)(n.h2,{id:"bootstrap--stub-client-side-javascript-flags-and-configs",children:"Bootstrap & Stub Client-side JavaScript flags and configs"}),"\n",(0,t.jsx)(n.p,{children:"If you're using JavaScript on the client side, you can use the Prefab Ruby client to bootstrap your client-side flags and configs. This helps you avoid loading states while you wait on an HTTP request to Prefab's evaluation endpoint. You can skip the HTTP request altogether."}),"\n",(0,t.jsx)(n.h3,{id:"with-the-frontend-sdks",children:"With the Frontend SDKs"}),"\n",(0,t.jsxs)(n.p,{children:["If you want the power of the ",(0,t.jsx)(n.a,{href:"/docs/sdks/javascript",children:"JavaScript SDK"})," or ",(0,t.jsx)(n.a,{href:"/docs/sdks/react",children:"React SDK"}),", you can use the Ruby client to bootstrap the page with the evaluated flags and configs for the current user context. Just put this in the DOM (perhaps in your application layout) before you load your Prefab frontend SDK."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-erb",children:"<%== Prefab.bootstrap_javascript(context) %>\n"})}),"\n",(0,t.jsx)(n.p,{children:"Things work as they normally would with the frontend SDKs, you'll just skip the HTTP request."}),"\n",(0,t.jsx)(n.h3,{id:"without-the-frontend-sdks",children:"Without the Frontend SDKs"}),"\n",(0,t.jsxs)(n.p,{children:["If you don't want to use the frontend SDKs, you can get a global ",(0,t.jsx)(n.code,{children:"window.prefab"})," object to call ",(0,t.jsx)(n.code,{children:"get"})," and ",(0,t.jsx)(n.code,{children:"isEnabled"})," on the client side."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-erb",children:"<%= Prefab.generate_javascript_stub(context, callback = nil) %>\n"})}),"\n",(0,t.jsx)(n.p,{children:"This will give you feature flags and config values for your current context. You can provide an optional callback to record experiment exposures or other metrics. No HTTP request or SDK needed!"}),"\n",(0,t.jsx)(n.h2,{id:"testing",children:"Testing"}),"\n",(0,t.jsx)(n.h3,{id:"test-setup",children:"Test Setup"}),"\n",(0,t.jsxs)(n.p,{children:["You can use a datafile for consistency, reproducibility, and offline testing. See ",(0,t.jsx)(n.a,{href:"/docs/explanations/concepts/testing#testing-with-datafiles",children:"Testing with DataFiles"}),"."]}),"\n",(0,t.jsx)(n.p,{children:"If you need to test multiple scenarios that depend on a single config or feature key, you can change the Prefab value using a mock or stub."}),"\n",(0,t.jsx)(n.h3,{id:"example-test",children:"Example Test"}),"\n",(0,t.jsxs)(n.p,{children:["Imagine we want to test a ",(0,t.jsx)(n.code,{children:"batches"})," method on our ",(0,t.jsx)(n.code,{children:"Job"})," class. ",(0,t.jsx)(n.code,{children:"batches"})," depends on ",(0,t.jsx)(n.code,{children:"job.batch.size"})," and the value for ",(0,t.jsx)(n.code,{children:"job.batch.size"})," in our default config file is ",(0,t.jsx)(n.code,{children:"3"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["We can test how ",(0,t.jsx)(n.code,{children:"batches"})," performs with different values for ",(0,t.jsx)(n.code,{children:"job.batch.size"})," by mocking the return value of ",(0,t.jsx)(n.code,{children:"Prefab.get"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"class Job < Array\n  def batches\n    slice_size = Prefab.get('job.batch.size')\n    each_slice(slice_size)\n  end\nend\n\nRSpec.describe Job do\n  describe '#batches' do\n    it 'returns batches of jobs' do\n      jobs = Job.new([1, 2, 3, 4, 5])\n\n      expect(jobs.batches.map(&:size)).to eq([3, 2])\n\n      allow(Prefab).to receive(:get).with('job.batch.size').and_return(2)\n      expect(jobs.batches.map(&:size)).to eq([2, 2, 1])\n    end\n  end\nend\n"})}),"\n",(0,t.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,t.jsx)(n.h3,{id:"client-initialization-options",children:"Client Initialization Options"}),"\n",(0,t.jsx)(n.p,{children:"For more control, you can initialize your client with options. Here are the defaults with explanations."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ruby",children:"options = Prefab::Options.new(\n  api_key: ENV['PREFAB_API_KEY'],\n  prefab_api_url: ENV['PREFAB_API_URL'] || 'https://api.prefab.cloud',\n  on_no_default: ON_NO_DEFAULT::RAISE, # options :raise, :warn_and_return_nil,\n  initialization_timeout_sec: 10, # how long to wait before on_init_failure\n  on_init_failure: ON_INITIALIZATION_FAILURE::RAISE, # choose to crash or continue with local data only if unable to fetch config data from prefab at startup\n  prefab_datasources: ENV['PREFAB_DATASOURCES'] == 'LOCAL_ONLY' ? DATASOURCES::LOCAL_ONLY : DATASOURCES::ALL,\n  prefab_config_override_dir: Dir.home,\n  prefab_config_classpath_dir: '.', # where to load local overrides\n  prefab_envs: ENV['PREFAB_ENVS'].nil? ? [] : ENV['PREFAB_ENVS'].split(','),\n  collect_logger_counts: true, # send counts of logger usage back to Prefab to power log-levels configuration screen\n  collect_max_paths: DEFAULT_MAX_PATHS,\n  collect_sync_interval: nil,\n  context_upload_mode: :periodic_example, # :periodic_example, :shape_only, :none\n  context_max_size: DEFAULT_MAX_EVAL_SUMMARIES,\n  collect_evaluation_summaries: true, # send counts of config/flag evaluation results back to Prefab to view in web app\n  collect_max_evaluation_summaries: DEFAULT_MAX_EVAL_SUMMARIES,\n  allow_telemetry_in_local_mode: false,\n  global_context: {}\n)\n\nPrefab.init(options)\n"})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}function h(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}},8453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var t=i(6540);const a={},s=t.createContext(a);function r(e){const n=t.useContext(s);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:r(e.components),t.createElement(s.Provider,{value:n},e.children)}}}]);