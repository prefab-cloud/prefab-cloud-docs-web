"use strict";(self.webpackChunkprefab_cloud_docs_web=self.webpackChunkprefab_cloud_docs_web||[]).push([[462],{3905:(e,r,n)=>{n.d(r,{Zo:()=>p,kt:()=>m});var t=n(7294);function l(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function o(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function a(e){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?o(Object(n),!0).forEach((function(r){l(e,r,n[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))}))}return e}function i(e,r){if(null==e)return{};var n,t,l=function(e,r){if(null==e)return{};var n,t,l={},o=Object.keys(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||(l[n]=e[n]);return l}(e,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)n=o[t],r.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(l[n]=e[n])}return l}var s=t.createContext({}),c=function(e){var r=t.useContext(s),n=r;return e&&(n="function"==typeof e?e(r):a(a({},r),e)),n},p=function(e){var r=c(e.components);return t.createElement(s.Provider,{value:r},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var r=e.children;return t.createElement(t.Fragment,{},r)}},g=t.forwardRef((function(e,r){var n=e.components,l=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=c(n),g=l,m=u["".concat(s,".").concat(g)]||u[g]||d[g]||o;return n?t.createElement(m,a(a({ref:r},p),{},{components:n})):t.createElement(m,a({ref:r},p))}));function m(e,r){var n=arguments,l=r&&r.mdxType;if("string"==typeof e||l){var o=n.length,a=new Array(o);a[0]=g;var i={};for(var s in r)hasOwnProperty.call(r,s)&&(i[s]=r[s]);i.originalType=e,i[u]="string"==typeof e?e:l,a[1]=i;for(var c=2;c<o;c++)a[c]=n[c];return t.createElement.apply(null,a)}return t.createElement.apply(null,n)}g.displayName="MDXCreateElement"},964:(e,r,n)=>{n.r(r),n.d(r,{assets:()=>s,contentTitle:()=>a,default:()=>d,frontMatter:()=>o,metadata:()=>i,toc:()=>c});var t=n(3117),l=(n(7294),n(3905));const o={title:"Dynamic Log Levels",sidebar_label:"Dynamic Log Levels"},a=void 0,i={unversionedId:"ruby-sdk/dynamic-log-levels",id:"ruby-sdk/dynamic-log-levels",title:"Dynamic Log Levels",description:"Setting Dynamic Log Levels",source:"@site/docs/ruby-sdk/dynamic-log-levels.md",sourceDirName:"ruby-sdk",slug:"/ruby-sdk/dynamic-log-levels",permalink:"/docs/ruby-sdk/dynamic-log-levels",draft:!1,editUrl:"https://github.com/prefab-cloud/prefab-cloud-docs-web/tree/main/docs/ruby-sdk/dynamic-log-levels.md",tags:[],version:"current",frontMatter:{title:"Dynamic Log Levels",sidebar_label:"Dynamic Log Levels"},sidebar:"tutorialSidebar",previous:{title:"Ruby",permalink:"/docs/ruby-sdk/ruby"},next:{title:"Java SDK",permalink:"/docs/category/java-sdk"}},s={},c=[{value:"Setting Dynamic Log Levels",id:"setting-dynamic-log-levels",level:2}],p={toc:c},u="wrapper";function d(e){let{components:r,...n}=e;return(0,l.kt)(u,(0,t.Z)({},p,n,{components:r,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"setting-dynamic-log-levels"},"Setting Dynamic Log Levels"),(0,l.kt)("p",null,"An example here is worth a million words."),(0,l.kt)("p",null,"First add a simple controller."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},'class PrefabController < ApplicationController\n  def index\n    Rails.logger.warn "warn level logging"\n    Rails.logger.info "info level logging"\n    Rails.logger.debug "debug level logging"\n\n    render plain: "Loaded. Check your logs."\n  end\nend\n')),(0,l.kt)("p",null,"Next, we'll set the Rails logger to use our logger"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-ruby"},"#application.rb\n$prefab = Prefab::Client.new\n$prefab.set_rails_loggers\n")),(0,l.kt)("admonition",{type:"info"},(0,l.kt)("p",{parentName:"admonition"},"Please read the ",(0,l.kt)("a",{parentName:"p",href:"/docs/ruby-sdk/ruby#special-considerations-with-forking-servers-like-puma--unicorn-that-use-workers"},"Puma/Unicorn")," notes for special considerations with forking servers.")),(0,l.kt)("p",null,"Finally we can start adjusting log levels. For convenience, we'll set these in our local defaults (",(0,l.kt)("a",{parentName:"p",href:"/docs/explanations/defaults"},"learn more"),") but you can set and tweak these on-the-fly in the Prefab web app."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"#.prefab.default.config.yaml\nlog-level:\n  _: debug\n  cloud.prefab: debug\n  app.controllers.prefab_controller: debug\n")),(0,l.kt)("p",null,"Our results speak for themselves. You can see that we've enabled debug for the prefab internals, rails internals and our application code."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},'DEBUG 2022-09-06 13:01:54 -0400: cloud.prefab.client.sse:  Received event: #<struct SSE::StreamEvent type=:message, id=nil, last_event_id=nil>\nDEBUG 2022-09-06 13:01:54 -0400: cloud.prefab.client.load_configs:  Checkpoint with highwater id 16621316872267098 from sse. No changes.\nDEBUG 2022-09-06 13:02:03 -0400:  active_support.log_subscriber.debug:    (1.0ms)  SELECT "schema_migrations"."version" FROM "schema_migrations" ORDER BY "schema_migrations"."version" ASC\nDEBUG 2022-09-06 13:02:03 -0400:  active_record.log_subscriber.log_query_source:   \u21b3 /Users/...\nWARN  2022-09-06 13:02:03 -0400:  app.controllers.prefab_controller.index: warn level logging\nINFO  2022-09-06 13:02:03 -0400:  app.controllers.prefab_controller.index: info level logging\nDEBUG 2022-09-06 13:02:03 -0400:  app.controllers.prefab_controller.index: debug level logging\nDEBUG 2022-09-06 13:02:03 -0400:  active_record.log_subscriber.log_query_source:   \u21b3 app/views/layouts/application.html.haml:47\nINFO  2022-09-06 13:05:17 -0400:  lograge.log_subscriber.process_action: method=GET path=/prefab format=html controller=PrefabController action=index status=200 duration=151.10 view=141.43 db=6.20\n')),(0,l.kt)("p",null,"If we set our levels to ",(0,l.kt)("inlineCode",{parentName:"p"},"info"),", we see much less logging."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-yaml"},"#.prefab.default.config.yaml\nlog-level:\n  _: info\n  cloud.prefab: info\n  app.controllers.prefab_controller: info\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"INFO  2022-09-06 13:05:17 -0400:  app.controllers.prefab_controller.index: info level logging\nINFO  2022-09-06 13:05:17 -0400:  lograge.log_subscriber.process_action: method=GET path=/prefab format=html controller=PrefabController action=index status=200 duration=151.10 view=141.43 db=6.20\n")),(0,l.kt)("admonition",{type:"tip"},(0,l.kt)("p",{parentName:"admonition"},"If the values are in your ",(0,l.kt)("inlineCode",{parentName:"p"},".prefab.default.config.yaml")," you'll need to restart the server to see new values. If you change these values on the server, they will update automatically.")),(0,l.kt)("p",null,"Now we are free to adjust our log levels, down to the controller or method level in realtime. Invaluable for debugging!"),(0,l.kt)("p",null,"Enjoy!"))}d.isMDXComponent=!0}}]);