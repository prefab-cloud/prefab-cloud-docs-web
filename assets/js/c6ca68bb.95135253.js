"use strict";(self.webpackChunkprefab_cloud_docs_web=self.webpackChunkprefab_cloud_docs_web||[]).push([[397],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>g});var r=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=r.createContext({}),c=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},d=function(e){var n=c(e.components);return r.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},u=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,l=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=c(t),g=a,m=u["".concat(s,".").concat(g)]||u[g]||p[g]||l;return t?r.createElement(m,i(i({ref:n},d),{},{components:t})):r.createElement(m,i({ref:n},d))}));function g(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var l=t.length,i=new Array(l);i[0]=u;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o.mdxType="string"==typeof e?e:a,i[1]=o;for(var c=2;c<l;c++)i[c]=t[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,t)}u.displayName="MDXCreateElement"},8775:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>c});var r=t(7462),a=(t(7294),t(3905));const l={title:"Dynamic Log Levels",sidebar_label:"Dynamic Log Levels"},i=void 0,o={unversionedId:"elixir-sdk/dynamic_log_levels",id:"elixir-sdk/dynamic_log_levels",title:"Dynamic Log Levels",description:"Setting Dynamic Log Levels",source:"@site/docs/elixir-sdk/dynamic_log_levels.md",sourceDirName:"elixir-sdk",slug:"/elixir-sdk/dynamic_log_levels",permalink:"/docs/elixir-sdk/dynamic_log_levels",draft:!1,editUrl:"https://github.com/prefab-cloud/prefab-cloud-docs-web/tree/main/docs/elixir-sdk/dynamic_log_levels.md",tags:[],version:"current",frontMatter:{title:"Dynamic Log Levels",sidebar_label:"Dynamic Log Levels"},sidebar:"tutorialSidebar",previous:{title:"Elixir",permalink:"/docs/elixir-sdk/elixir"},next:{title:"JavaScript Client",permalink:"/docs/javascript"}},s={},c=[{value:"Setting Dynamic Log Levels",id:"setting-dynamic-log-levels",level:2},{value:"Trace IDs",id:"trace-ids",level:3}],d={toc:c};function p(e){let{components:n,...t}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("h2",{id:"setting-dynamic-log-levels"},"Setting Dynamic Log Levels"),(0,a.kt)("p",null,"A simple example here is worth a million words."),(0,a.kt)("p",null,"First add a simple module."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},'defmodule PrefabLogTest do\n  def run(client) do\n    Prefab.Client.warning(client, "warn level logging")\n    Prefab.Client.info(client, "info level logging")\n    Prefab.Client.debug(client, "debug level logging")\n  end\nend\n')),(0,a.kt)("p",null,"By default, ",(0,a.kt)("inlineCode",{parentName:"p"},"Prefab"),"'s global log level is configured at ",(0,a.kt)("inlineCode",{parentName:"p"},":warning"),", so running ",(0,a.kt)("inlineCode",{parentName:"p"},"PrefabLogTest.run(client)")," we would only see"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"12:01:16.808 [warning] prefab_log_test.warning: warning\n")),(0,a.kt)("p",null,"But we can change the final output by adjusting log levels."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"#.prefab.default.config.yaml\nlog-level:\n  prefab_log_test: debug\n")),(0,a.kt)("p",null,"Our results speak for themselves. You can see that we've enabled debug for the prefab internals, rails internals and our application code."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"12:01:16.807 [debug] prefab_log_test.debug: debug\n\n12:01:16.807 [info] prefab_log_test.info: info\n\n12:01:16.808 [warning] prefab_log_test.warning: warning\n")),(0,a.kt)("p",null,"We can also set the global ",(0,a.kt)("inlineCode",{parentName:"p"},"log-level")," to reduce logging"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},"#.prefab.default.config.yaml\nlog-level:\n  _: info\n")),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"12:01:16.807 [info] prefab_log_test.info: info\n\n12:01:16.808 [warning] prefab_log_test.warning: warning\n")),(0,a.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,a.kt)("div",{parentName:"div",className:"admonition-heading"},(0,a.kt)("h5",{parentName:"div"},(0,a.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,a.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,a.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"tip")),(0,a.kt)("div",{parentName:"div",className:"admonition-content"},(0,a.kt)("p",{parentName:"div"},"If the values are in your ",(0,a.kt)("inlineCode",{parentName:"p"},".prefab.default.config.yaml")," you'll need to restart the server to see new values. If you change these values on the server, they will update automatically."))),(0,a.kt)("p",null,"Now we are free to adjust our log levels, down to the controller or method level in realtime. Invaluable for debugging!"),(0,a.kt)("h3",{id:"trace-ids"},"Trace IDs"),(0,a.kt)("p",null,"A final trick to share is adding in the concept of ",(0,a.kt)("inlineCode",{parentName:"p"},"trace-ids"),". This isn't a new feature per-se, it's really just a cool\nway to use regular Prefab config. To do it, we can just create a new string config called trace-ids. Put in a comma delimitted list of user ids.\nThen look for this value and only log if our current user is in the list."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-ruby"},'trace_ids =\n  Prefab.Client.get(client, "trace-ids")\n  |> String.split(trim: true)\n\nif to_string(user_id) in trace_ids do\n  Prefab.Client.debug(client, "very detailed logging")\nend\n')),(0,a.kt)("p",null,"Enjoy!"))}p.isMDXComponent=!0}}]);