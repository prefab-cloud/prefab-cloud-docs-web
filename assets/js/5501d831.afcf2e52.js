"use strict";(self.webpackChunkprefab_cloud_docs_web=self.webpackChunkprefab_cloud_docs_web||[]).push([[6176],{4535:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>s,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>t,toc:()=>d});var o=r(4848),i=r(8453);const l={title:"CLI",sidebar_label:"CLI"},a="CLI",t={id:"tools/cli",title:"CLI",description:"The Prefab CLI provides powerful tools for creating, modifying, and getting information about your configuration and flags.",source:"@site/docs/tools/cli.md",sourceDirName:"tools",slug:"/tools/cli",permalink:"/docs/tools/cli",draft:!1,unlisted:!1,editUrl:"https://github.com/prefab-cloud/prefab-cloud-docs-web/tree/main/docs/tools/cli.md",tags:[],version:"current",frontMatter:{title:"CLI",sidebar_label:"CLI"},sidebar:"tutorialSidebar",previous:{title:"Tools",permalink:"/docs/category/tools"},next:{title:"Editor Tools",permalink:"/docs/tools/editor-tools"}},s={},d=[{value:"Installation",id:"installation",level:2},{value:"Usage",id:"usage",level:2},{value:"Providing your API Key",id:"providing-your-api-key",level:3},{value:"change-default",id:"change-default",level:3},{value:"create",id:"create",level:3},{value:"download",id:"download",level:3},{value:"<code>get</code>",id:"get",level:3},{value:"Interpolating a value from Prefab",id:"interpolating-a-value-from-prefab",level:4},{value:"info",id:"info",level:3},{value:"list",id:"list",level:3},{value:"override",id:"override",level:3},{value:"serve",id:"serve",level:3}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,i.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"cli",children:"CLI"})}),"\n",(0,o.jsx)(n.p,{children:"The Prefab CLI provides powerful tools for creating, modifying, and getting information about your configuration and flags."}),"\n",(0,o.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,o.jsx)(n.p,{children:"On a system with Node version 18+, run"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"npm install -g @prefab-cloud/prefab\n"})}),"\n",(0,o.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,o.jsxs)(n.p,{children:["See ",(0,o.jsx)(n.code,{children:"prefab --help"})," for all the available commands. ",(0,o.jsx)(n.code,{children:"prefab [COMMAND] --help"})," will give you detailed information about a given command."]}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab"})," is designed for humans first, but all commands support a ",(0,o.jsx)(n.code,{children:"--json"})," flag to output JSON instead."]}),"\n",(0,o.jsx)(n.h3,{id:"providing-your-api-key",children:"Providing your API Key"}),"\n",(0,o.jsxs)(n.p,{children:["You must export ",(0,o.jsx)(n.code,{children:"PREFAB_API_KEY"})," or provide your API key via the ",(0,o.jsx)(n.code,{children:"--api-key=XYZ"})," flag."]}),"\n",(0,o.jsxs)(r,{children:[(0,o.jsx)("summary",{children:"Using the 1password cli for your API key"}),(0,o.jsxs)(n.p,{children:["To use the ",(0,o.jsx)(n.a,{href:"https://developer.1password.com/docs/cli/get-started",children:"1password cli"})," for this, you can do the following (replace the ",(0,o.jsx)(n.code,{children:"op://..."})," with the secret reference for your API key)."]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:'prefab --api-key=(op read "op://Private/Prefab API KEY/credential")\n'})})]}),"\n",(0,o.jsx)(n.h3,{id:"change-default",children:"change-default"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab change-default NAME"})," allows you to change the default value for an environment. Any rules defined for that environment will still apply; only the default is changed."]}),"\n",(0,o.jsx)(n.p,{children:"This can be particularly helpful for flipping a flag on or off for everyone."}),"\n",(0,o.jsx)(n.p,{children:"Example:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"prefab change-default my.flag.name --value=true --environment=staging"})}),"\n",(0,o.jsx)(n.h3,{id:"create",children:"create"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab create NAME"})," creates a new flag or config in Prefab. You can use this to create basic values, encrypted secrets, or values provided by ENV vars."]}),"\n",(0,o.jsxs)(n.p,{children:["Example: ",(0,o.jsx)(n.code,{children:'prefab create my.new.string --type string --value="hello world" --secret'})]}),"\n",(0,o.jsx)(n.h3,{id:"download",children:"download"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab download"})," will download a datafile for a given environment. ",(0,o.jsx)(n.a,{href:"/docs/explanations/concepts/testing",children:"Datafiles"})," are helpful for offline testing, CI, and running your own JS/React endpoint with the ",(0,o.jsx)(n.a,{href:"#serve",children:(0,o.jsx)(n.code,{children:"serve"})})," command."]}),"\n",(0,o.jsx)(n.p,{children:"Example:"}),"\n",(0,o.jsx)(n.p,{children:(0,o.jsx)(n.code,{children:"prefab download --environment=test"})}),"\n",(0,o.jsx)(n.h3,{id:"get",children:(0,o.jsx)(n.code,{children:"get"})}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab get NAME"})," will give you the value for a config in the environment tied to your API key."]}),"\n",(0,o.jsxs)(n.p,{children:["Example: ",(0,o.jsx)(n.code,{children:"prefab get aws.bucket"})]}),"\n",(0,o.jsx)(n.h4,{id:"interpolating-a-value-from-prefab",children:"Interpolating a value from Prefab"}),"\n",(0,o.jsx)(n.p,{children:"Since the CLI is a well-behaved citizen of the command line, you can use it to compose other commands."}),"\n",(0,o.jsxs)(n.p,{children:["Here's an example command to download a file from s3 using the ",(0,o.jsx)(n.a,{href:"https://aws.amazon.com/cli/",children:"aws cli"}),". Prefab values are interpolated for the aws key and bucket name."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"aws s3api get-object \\\n  --bucket $(prefab get aws.bucket) \\\n  --key $(prefab get aws.db.backup.filename) \\\n  db.tgz\n"})}),"\n",(0,o.jsxs)(n.p,{children:["As you'd expect, you can similarly use ",(0,o.jsx)(n.code,{children:"prefab"})," in a pipeline with ",(0,o.jsx)(n.code,{children:"xargs"})," and similar."]}),"\n",(0,o.jsx)(n.h3,{id:"info",children:"info"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab info NAME"})," will show details about an item in Prefab. Example output:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"prefab info aws.bucket\n\nhttps://app.cloud/account/projects/XYZ/configs/aws.bucket\n\n- Default: false\n- Staging: true\n- Production: [see rules] https://app.cloud/account/projects/XYZ/configs/aws.bucket?environment=588\n\nEvaluations over the last 24 hours:\n\nProduction: 34,789\n- 33% - false\n- 67% - true\n\nStaging: 17,138\n- 100% - true\n\nDevelopment: 7\n- 100% - false\n"})}),"\n",(0,o.jsx)(n.h3,{id:"list",children:"list"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab list"})," will show the names of items in your Prefab account. You can pass flags to filter this to only show items of a specific type (e.g. segments)."]}),"\n",(0,o.jsx)(n.h3,{id:"override",children:"override"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab override"})," lets you override the value for a config or feature flag for your prefab.cloud user. This is especially helpful for testing both sides of a feature flag."]}),"\n",(0,o.jsx)(n.p,{children:"Are you using a backend key for your server code and a frontend key for your UI? No problem; this override will apply to any environment using an API key created by your prefab.cloud user."}),"\n",(0,o.jsxs)(n.p,{children:["Example: ",(0,o.jsx)(n.code,{children:"prefab override my.flag.name --value=true"})]}),"\n",(0,o.jsx)(n.h3,{id:"serve",children:"serve"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"prefab serve"})," will start a local server to serve up a local datafile that React and JS clients can talk to. See ",(0,o.jsx)(n.code,{children:"prefab download"})," for more."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"prefab serve prefab.test.588.config.json\nServer is listening on 3099. Press ctrl-c to stop.\n"})}),"\n",(0,o.jsx)(n.p,{children:"Example Dockerfile"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"FROM node:20\nWORKDIR /app\nRUN npm i -g @prefab-cloud/prefab\nCOPY prefab.Production.589.config.json /app\nENV PREFAB_LOCAL_ONLY=true\nEXPOSE 9898\nCMD prefab serve prefab.Production.589.config.json --port=9898\n"})})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(c,{...e})}):c(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>t});var o=r(6540);const i={},l=o.createContext(i);function a(e){const n=o.useContext(l);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);