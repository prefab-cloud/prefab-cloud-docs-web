"use strict";(self.webpackChunkprefab_cloud_docs_web=self.webpackChunkprefab_cloud_docs_web||[]).push([[1761],{5680:(e,n,o)=>{o.d(n,{xA:()=>u,yg:()=>y});var r=o(6540);function t(e,n,o){return n in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o,e}function a(e,n){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),o.push.apply(o,r)}return o}function s(e){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?a(Object(o),!0).forEach((function(n){t(e,n,o[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(o,n))}))}return e}function i(e,n){if(null==e)return{};var o,r,t=function(e,n){if(null==e)return{};var o,r,t={},a=Object.keys(e);for(r=0;r<a.length;r++)o=a[r],n.indexOf(o)>=0||(t[o]=e[o]);return t}(e,n);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)o=a[r],n.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(t[o]=e[o])}return t}var l=r.createContext({}),p=function(e){var n=r.useContext(l),o=n;return e&&(o="function"==typeof e?e(n):s(s({},n),e)),o},u=function(e){var n=p(e.components);return r.createElement(l.Provider,{value:n},e.children)},f="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var o=e.components,t=e.mdxType,a=e.originalType,l=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),f=p(o),c=t,y=f["".concat(l,".").concat(c)]||f[c]||d[c]||a;return o?r.createElement(y,s(s({ref:n},u),{},{components:o})):r.createElement(y,s({ref:n},u))}));function y(e,n){var o=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var a=o.length,s=new Array(a);s[0]=c;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[f]="string"==typeof e?e:t,s[1]=i;for(var p=2;p<a;p++)s[p]=o[p];return r.createElement.apply(null,s)}return r.createElement.apply(null,o)}c.displayName="MDXCreateElement"},1631:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>b,frontMatter:()=>a,metadata:()=>i,toc:()=>p});var r=o(8168),t=(o(6540),o(5680));const a={title:"Offline Mode",sidebar_label:"Offline Mode"},s=void 0,i={unversionedId:"how-tos/offline-mode",id:"how-tos/offline-mode",title:"Offline Mode",description:"Prefab is intended to be bomb-proof. This means that your servers should happily continue to evaluate feature flags and config, even if, despite our intense efforts, our servers are down. As a developer, you should also be able to run your app and test your code even if you don't have a reliable internet connection. This is why Prefab has an offline mode.",source:"@site/docs/how-tos/offline-mode.md",sourceDirName:"how-tos",slug:"/how-tos/offline-mode",permalink:"/docs/how-tos/offline-mode",draft:!1,editUrl:"https://github.com/prefab-cloud/prefab-cloud-docs-web/tree/main/docs/how-tos/offline-mode.md",tags:[],version:"current",frontMatter:{title:"Offline Mode",sidebar_label:"Offline Mode"},sidebar:"tutorialSidebar",previous:{title:"Feature Opt-In",permalink:"/docs/how-tos/feature-opt-in"},next:{title:"Rollouts",permalink:"/docs/how-tos/rollouts"}},l={},p=[{value:"Using Prefab offline",id:"using-prefab-offline",level:2},{value:"Backend SDKs",id:"backend-sdks",level:3},{value:"Frontend SDKs",id:"frontend-sdks",level:3},{value:"Using Backend SDK JS stub/bootstrapping",id:"using-backend-sdk-js-stubbootstrapping",level:4},{value:"Using the Prefab CLI to Serve a datafile",id:"using-the-prefab-cli-to-serve-a-datafile",level:4}],u=e=>function(n){return console.warn("Component "+e+" was not imported, exported, or provided by MDXProvider as global scope"),(0,t.yg)("div",n)},f=u("Tabs"),d=u("TabItem"),c={toc:p},y="wrapper";function b(e){let{components:n,...o}=e;return(0,t.yg)(y,(0,r.A)({},c,o,{components:n,mdxType:"MDXLayout"}),(0,t.yg)("p",null,"Prefab is intended to be bomb-proof. This means that your servers should happily continue to evaluate feature flags and config, even if, despite our ",(0,t.yg)("a",{parentName:"p",href:"../explanations/architecture/resiliency"},"intense efforts"),", our servers are down. As a developer, you should also be able to run your app and test your code even if you don't have a reliable internet connection. This is why Prefab has an offline mode."),(0,t.yg)("h2",{id:"using-prefab-offline"},"Using Prefab offline"),(0,t.yg)("p",null,"Prefab has Backend and Frontend SDKs, each supporting offline mode using ",(0,t.yg)("a",{parentName:"p",href:"../explanations/concepts/datafiles"},"Datafiles"),". Datafiles are JSON files containing the feature flags and configs you would normally get from the Prefab servers."),(0,t.yg)("p",null,"You can ",(0,t.yg)("a",{parentName:"p",href:"../tools/cli#download"},"download the datafile")," for your project with the Prefab CLI."),(0,t.yg)("p",null,"You can check this datafile into your source control system, and use it to run your app in offline mode. Be sure to update this datafile periodically to get the latest rulesets from the Prefab servers."),(0,t.yg)("h3",{id:"backend-sdks"},"Backend SDKs"),(0,t.yg)("p",null,"Backend SDKs can use ",(0,t.yg)("a",{parentName:"p",href:"../explanations/concepts/datafiles"},"Datafiles")," to run in offline mode. By specifying ",(0,t.yg)("inlineCode",{parentName:"p"},"PREFAB_DATAFILE=./path-to-your-datafile.json")," in your environment, you can run your app without needing to connect to the Prefab servers. Since the datafile is a complete representation of the payload you'd normally get from prefab.cloud, your servers will continue to evaluate flags and configs using your complete ruleset (at the time the datafile was generated)."),(0,t.yg)("p",null,"If you're using Ruby on Rails, for example, you can run your server using a datafile like this:"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-bash"},"PREFAB_DATAFILE=./path-to-your-datafile.json rails server\n")),(0,t.yg)("h3",{id:"frontend-sdks"},"Frontend SDKs"),(0,t.yg)("p",null,"Frontend SDKs have two options for offline mode. In both cases, you'll need a datafile."),(0,t.yg)("h4",{id:"using-backend-sdk-js-stubbootstrapping"},"Using Backend SDK JS stub/bootstrapping"),(0,t.yg)("p",null,"If you're already using one of the Backend SDKs that supports ",(0,t.yg)("a",{parentName:"p",href:"../explanations/concepts/zero-ms-frontend-feature-flags"},"Frontend bootstrapping"),", you can use the same datafile for your frontend. Sending your evaluations from your backend to your frontend will save your users an HTTP request and allow you to run offline without any changes to your frontend code."),(0,t.yg)("h4",{id:"using-the-prefab-cli-to-serve-a-datafile"},"Using the Prefab CLI to Serve a datafile"),(0,t.yg)("p",null,"Using ",(0,t.yg)("a",{parentName:"p",href:"../tools/cli#serve"},(0,t.yg)("inlineCode",{parentName:"a"},"prefab serve"))," with a datafile will start a local server that serves the datafile to your frontend. This is useful if you're not using a Backend SDK that supports bootstrapping, or if you want to run your frontend in isolation. You'll need to update your frontend code to point to wherever your ",(0,t.yg)("inlineCode",{parentName:"p"},"prefab serve")," is running."),(0,t.yg)(f,{groupId:"lang",mdxType:"Tabs"},(0,t.yg)(d,{value:"js",label:"JavaScript",mdxType:"TabItem"},(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-javascript"},'import { prefab } from "@prefab-cloud/prefab-cloud-js";\n\nconst endpoints = [\n  // If using the prefab serve command locally\n  "http://localhost:3099",\n  // If using `prefab serve` on your server\n  // (perhaps in a Docker image), use the server\'s URI here\n  // "https://prefab.your-backend-server/",\n];\n\nconst options = {\n  apiKey: "YOUR_CLIENT_API_KEY",\n  endpoints: endpoints,\n};\n\nawait prefab.init(options);\n'))),(0,t.yg)(d,{value:"react",label:"React",mdxType:"TabItem"},(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-jsx"},'import { PrefabProvider } from "@prefab-cloud/prefab-cloud-react";\n\nconst endpoints = [\n  // If using the prefab serve command locally\n  "http://localhost:3099",\n  // If using `prefab serve` on your server\n  // (perhaps in a Docker image), use the server\'s URI here\n  // "https://prefab.your-backend-server/",\n];\n\nconst WrappedApp = () => {\n  const onError = (reason) => {\n    console.error(reason);\n  };\n\n  return (\n    <PrefabProvider\n      endpoints={endpoints}\n      apiKey={"YOUR_CLIENT_API_KEY"}\n      onError={onError}\n    >\n      <MyApp />\n    </PrefabProvider>\n  );\n};\n')))))}b.isMDXComponent=!0}}]);